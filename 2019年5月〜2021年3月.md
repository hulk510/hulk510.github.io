## プロジェクトの詳細

Webサイトリニューアル開発のフロントエンドとして途中から参加。開発初期はリニューアルタスクの実装、QA、バグ修正を担当しました。
リニューアル後、保守運用フェーズではリリース作業や管理画面の修正など担当する範囲を広げ、お客様との打ち合わせや仕様決めに参加しました。また、その中で要件定義・保守改修・新規開発タスクの実装とスケジュール調整を担当。
後任へのプロジェクト引き継ぎ時、プロジェクトの全体像や知見を共有しすぐに参加できるよう情報整理と共有を実施。

## 使用技術

- フロントエンド：React, Redux
- バックエンド：Go（API）, PHP（管理画面）
- インフラ周り：AWS, Jenkins, Docker, MySQL
- チケット管理：Redmine

## 参加期間

- 2019年5月~2021年3月

## 開発規模

- リニューアル時期：11人
- 保守運用フェーズ：3~4人

## プロジェクトでの課題

フレームワークを使って簡単なプログラミングができる程度の実力で案件に参加したため、全体的に必要な知識が不足していることが課題だった。

## 主な取り組み

### フロントエンド

- 基礎知識のキャッチアップ

  プロジェクトに参加して簡単な開発タスクを進める中で開発についていくだけの力がなく、説明を受けても基礎的な知識がなくそれらの情報の必要性を感じ実力不足を埋めるため、以下のような流れで本やwebなどで自己学習を進めました。

  1. 簡単なタスクをこなしながらプロジェクトコードの理解

     まず、開発タスクでは簡単なCSSを書きページのデザインを修正するところから始めました。プロジェクトコードを読むだけでは修正するページを探したり、どの部分を変更すれば良いのか分からなかったため、先輩から開発者コンソールの使い方を教えてもらいました。デバッグツールを使い、ページ上から表示されてるタグの名前や使ってる文字から要素を検索し修正していきました。
     CSSライブラリはstyled-componentsを使っていたのでやりたいことベースでWeb検索し簡単にわかりCSSなどから、それっぽい設定を見つけてきて適応したり外したりを繰り返しながら修正しました。すでに適応されてるCSSなどが原因で要素の変化がわかりづらかったため、オフにしてみたりとプロパティ毎でどう変わるのかをみながらCSSの使い方を学びつつ進めました。

  2. JavaScriptの学習

     次にHTML,CSSの内容がざっくり分かったところでReactコンポーネントを修正するタスクを行うことになり、同じように試行錯誤しつつReactへの理解を深めようと考えました。
     チュートリアルのStateやPropsなどReactコードを見ているとJavaScript・Reactどちらの書き方かわからず、検索したいワードの言語化もできず悩むことが多く基礎を身につける必要があると感じました。
     そのため、先にJavaScriptの本を読みながら自己学習を始めました。ReactはJavaScriptから派生したものでそこを抑えておけば、JavaScriptの書き方かどうかだけ判断できれば少なくともJavaScriptは検索できるため、あとは検索でなんとかなると考えたためです。
     選んだ本に関しては、関係ありそうな本を複数もらっていたためそれらを読み進めました。読み進めるには難しいことや理解できないことは置いておいて、1冊に時間をかけるより全て読み切ることを優先して行いできる限り多くやることを意識しました。そして、1冊では分からなかった内容でも同じ内容の本を2,3冊読むとなんとなくコードが読めるようになってきてJavaScriptの基本は理解できるようになりました。また、検索したかったワードの定義を本で見つけ検索ワードを言語化できるようになったため、Reactの学習に移行しました。

  3. Reactの学習とコードリーディング

     Reactでも同じように本で学習を進め、基本の書き方や使い方を学んでいきました。JavaScriptを読めるようになっても、ReactではPropsが変えられないこと、バケツリレーして渡すなどReactの概念がよく分からなかったため本だけでは完全に理解できませんでした。そのため、本での勉強と並行してプロジェクトのコードを照らし合わせながら、本を読む方向に変えました。Reactを完全に理解できていなくてもJavaScriptのコードは読める、本のサンプルコードが具体的にどう言った活用されているか資料としてプロジェクトのコードを使いました。また、動いているコードなどを適宜デバッグしながら挙動の把握しながら、タスクの修正を行い簡単なコンポーネントの実装をしました。

  4. Redux、その他足りてない知識のキャッチアップとプロジェクトコードの把握

     開発を進めていくことで調べる力がついてきたため、あまり理解できてなかった部分や、Reduxの学習も適宜進めていきました。この頃から、まだ理解できていないコードが分かるようになる感覚が楽しくなり、触る必要のない箇所のコードを見ながらプロジェクトのコードがどう動いているのか調べながら開発していました。まだ理解できていなかった部分としてRedux、API連携などがあったため、それらの学習を次の目標として進めました。
     学習にあたってはRedmineから過去のPR、コミットを探し実装時の変更点を見るようにしました。Reduxの実装は複数ファイルで定義する必要があり、どのファイルに書くのか参考にするときPRやコミットは動く形としてコードがまとまっていて、Webで検索するよりも実装の参考にしやすいと考えたからです。
     そして、コードから何故こうしたのかをコミットやファイルの履歴から調べたり、ReduxのドキュメントやWeb記事をみて簡単なコードに分解して実装してみることでReduxの理解を深めました。
     Reduxの使い方に慣れてくるとコードが急に理解できるようになり、Redux内部から叩いていたAPIを理解するために今までやってきた流れで適宜不明な部分は聞くなどして開発できるタスクの幅を広げていきました。

- 問い合わせフォームの作成

  フロントエンドのコードを理解してきたため、問い合わせフォームをReactコンポーネントを1から作成するタスクに着手しました。作成にあたって、ページコンポーネント定義、デザイン作成、APIへのリクエストを行いStateを管理するReduxの定義、文字数バリデーションを実装しました。
  苦労した点は、フォームを送るにあたり2重でリクエストを送信してしまうバグの解決です。
  今までの学んだ部分の知識や進め方で概ね実装できましたが、送信ボタンをタップしてリクエストする間にもう一度ボタンを押すとフォームを2度送ることができていました。なぜそうなるのか原因が分からなかったため、まずは似たようなボタンで送信を行なっていそうな部分を調べることにしました。
  送信処理は他の部分でも使われていて似たような処理があると考えたため、サービス内ページの動線を想像しながらどこかでリクエストしている部分がないかを記憶から探り実装がありそうなページを探しました。それっぽい処理の記述がコードで見つかったため、その処理で使われていた部分のコードを読みボタン送信時にアクションをブロックしていたことが分かったためバグを修正しタスクを完了できました。送信時と完了時でStateを変更してそれ以外の時は処理を実行しないようにしていて、当時の理解ではロジックを実装に時間がかかるため、プロジェクト内のコードを参考にすることで素早く実装できたと考えています。また、実装でロジックを書く時、自分自身で考え実装するかどうかなどは以下の順で考えています。

  1. プロジェクト他に記述があるならそれを参考にする
  2. なければ、ロジックを考え何か便利メソッドでできないか調べる(配列であればfilter, mapなど)
  3. それでもないならやりたいことベースで調べながら実装する

  自己学習であれば試行錯誤しながら実装しますが、すでに誰かが実装したものを主に使えないかを考えることが多いです。理由としては、プロジェクト内で書かれている処理で合わせておくと後で見返しやすさ検索しやすさがあるためです。また、filterやmapなど便利メソッドを使うことで処理を簡単にしたりと用意されてるものを使うと綺麗で少ないコードで書くことができるためです。
  必死にロジックを実現するための処理を考えて組むよりも、他の人が書いたコードを調べる方が書き方を知る機会や足がかりになり、結果的に早く実装できると考えています。

### バックエンド

- 社内パッケージの一覧検索・CSV生成スピードの向上

  フロントエンドタスクがある程度こなせるようになり、保守作業に移行したためリソース削減のため担当者から受け持つ形で社内パッケージである、管理画面CMSのデータの検索・CSV生成機能のスピードを上げる開発をしました。
  検索機能の実現にあたって、

  - パッケージコアの機能を修正することは現実的でなかった事
  - 管理画面を使うユーザーは限られており機能として実現できることの方が優先事項

  これらの理由から社内で相談し管理画面に別途ページを作成してそのページだけの検索機能を作成することになりました。CSV生成のスピードに関しては、生成時データ検索がネックになっていて遅くなっていることが挙げられたため作成するページの検索を使うことでの修正を試みました。
  修正にあたって、HTMLから記事検索クエリをPHPに渡し、SQLでデータの取得とデータ表示を実装しました。検索ページでは元の重たくなっていたページと同じデザインで表示する必要があったため、CMS内にあるHTML構造を探したり、検索に使うフィルターなどに使われているCSSを調べ実装しました。
  実装時、検索と検索クエリでフィルター機能の実装に苦労しました。フレームワークを使わずPHPのみを使って実装するため、PHPの使い方、CMS内でのルーティング、検索機能はどのように実装するかなど実装にあたって考慮する点が多くありました。
  そのため、タスクの締め切りを考慮して今の実力で調べて解決できるだけのタスクではないと判断し、バックエンドのエンジニアと相談しながら進めていく方向に変更しました。調べればあとは開発できそうなタスクになるまで大まかな設計や、どの部分を修正するといいかなどを一緒に考えてもらいPHPの検索機能の実装に取り掛かりました。
  PHPではクエリを保持するため`$\_GET`変数を使い、Formリクエストを受け取りそのパラメーターからSQLを作成しデータのリクエストを行いました。実装したコードのレビュー時にはSQLインジェクションできる状態だと指摘を受け、検索クエリからSQLを叩くパラメータをエスケープし起こりづらいコードに変更して検索機能を作成しました。

### インフラ

- リリース作業の担当
  サービスの修正をリリースする作業の引き継ぎと実施を行ないました。デプロイには専用の端末を使いJenkinsから直接デプロイを走らせることで反映しました。dumpコマンドでテーブルのバックアップをとって何かあった時に戻せるように準備し、手順書に従いデプロイを担当しリリース後のサイトの確認リリース報告をしました。
  デプロイは、すでにJenkinsが構築されているため基本的には指定の順番通りに実行するでしたがいつも不安でした。なぜなら、検証端末でやるため操作はvimで行ったり、使えるアプリが制限されたり、具体的にデプロイ時何が行われているのか分からない状態だったからです。分からない事に漠然と不安を感じていたため、DockerでJenkinsのイメージを構築して使ってみることでvimやdocker、jenkinsにまずは慣れて何を行うものなのかを知れるようにしました。また、リリースで使われていたJenkinsの設定で書かれているスクリプトで何を行っているのかを調べることでできる限り何を行っているのかを知ることで不安を軽減しました。

### その他業務

- タスクの要件定義・設計

  保守運用フェーズでは、開発リソースの縮小に合わせてバックエンド・リリース作業と担当する部分が増えお客様との打ち合わせや要件定義・設計にも参加するようになりました。打ち合わせでは主にバグの修正タスクや、セキュリティ要件に添えるようにアップデートを行うタスクを進行しました。その際、やるタスクとやらないタスクの調整に注意しながら行うようにしました。保守運用の開発リソース内で収めていかないと徹夜でずっと開発する必要があると考えたためです。そうした開発では身がすり減るだけで生産的ではないことが多かったため、1ヶ月でどこまでがやるタスクで次にどこまでを行うのかを決め、差し込みで修正する場合は他タスクの組み替えを行い1ヶ月に行う仕事量の調整をしました。また、要件定義では現状のコードを見て大規模な改修が必要なタスクなどは代替案を提案し、できないで終わらせるのではなく実現可能な形で提案できるように心がけました。

- プロジェクト引き継ぎ作業
  別プロジェクトへ参加することになり後任担当者への引き継ぎを行いました。初めてプロジェクトに参加したときは色々な情報を調査するのに苦労したため今の状態をまとめ、そこからプロジェクト全体でアクセスできるようにする必要があると考えました。
  開発ドキュメントの整理や手順などドキュメント化されていない部分の書き出しを行い、みるべき資料の1元化を行いました。具体的には、まずプロジェクト内でアクセスできるファイルの一覧を作成しRedmine、仕様書、テストユーザーの情報など見ることになるファイルの一覧を作成しました。仕様書は実装で変わっている所などがあったため精査しながら変わっているところは適宜修正して、資料の一覧を作成しました。万が一記入漏れがあった時にどこを検索してどうすれば手掛かりを探していけるかなども合わせて付け加えることで調べる足掛かりは残しておけるようにしました。
  次に環境構築や開発に入る際のドキュメントを作成しました。ローカルでもう一度環境構築をしてみてちゃんと動くかの確認、動かない場所やわかりづらい手順の部分はREADMEの修正をしました。そして、開発時に詰まった部分やプロジェクトがどういった構成で動いているのかの説明を追記し調べる事に時間を使わなくて済むようにしました。

## 振り返り

実力不足を補うために本やWebなどで自己学習しましたが、成長できたと感じたのは実践があったからだと考えています。本でサンプルコードを実装しても基礎を書くことが多く、そこからの現場で使えるものに変える事は本だけでは難しいと感じていました。学習した内容とプロジェクトのコードリーディングを合わせて行うことで、より具体的に知識として定着していく実感がありました。
コードを動かしデバッグしながらサービスの把握を進めていけるため、何か実装する際もプロジェクトのコードをまずは動かしてみて触ってみるということが理解するのに一番早いと考えるようになりました。そのため新しいライブラリを試す場合は、サンプルコードなどを動かして試してみたりと導入する際に試行錯誤するのではなく、まず動いているコードで確認してから導入を心がけています。そうして、自己学習を通じて得た知識や技術はプロジェクトの改善やタスクの効率化につながったと感じています。また、時間がある時は学んだことをアウトプットすることでより具体的に知識を定着させることができたと考えています。（[React コンポーネントのブロック{} か()で何が違うのか](https://zenn.dev/hulk510/articles/e03ac1b6a7dd8e1692bb)）

管理画面でSQLインジェクションが可能なコードを書いた時も本で見たことはあり知っていた内容の話題でしたが、実装してみると案外理解できていない事に気づきました。レビュー時に指摘されたことでより身近に感じることができ、その際実際にSQLインジェクションをしてみてなぜこの状態だと起こるのかを考えることでより具体的に知識として吸収できたと考えています。

そのためこれらの経験を通して、本での自己学習はそれ単体で大切ですが使って初めて知識になると考え、できる限り手を動かして試行錯誤してみることを大切にしています。
その経験活かしてリリース時にはJenkinsやdockerなどもローカルで構築、設定してみたりと自己学習と実践することで完全に理解できてなくても、漠然と抱えていたリリース作業の不安を解消できたと考えています。

後任の引き継ぎに関しては、コードリーディングをしていたことで副次的にプロジェクトの概要を把握できていたことで情報が正しいかどうかを判断できたことで整理が比較的容易だったと考えています。
また、整理してまとめる作業をしたことで引き継ぎを説明をする時に次の担当者への説明がしやすく、連携がスムーズになりプロジェクトの引き継ぎを問題なく終えることができたと考えています。
